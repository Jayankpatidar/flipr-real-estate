<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="navbar">
  <div class="logo">Consultation & Marketing</div>
  <nav>
    <a href="index.html#home">Home</a>
    <a href="index.html#about">About</a>
    <a href="index.html#projects">Projects</a>
    <a href="index.html#clients">Clients</a>
    <a href="admin.html">Admin</a>
    <a href="index.html#contact" class="btn">Contact</a>
  </nav>
</header>

<div class="admin-container">
  <h2>Admin Panel</h2>

  <div class="admin-section">
    <h3>Add Project</h3>
    <div class="form-group">
      <label for="pimg">Project Image</label>
      <input id="pimg" type="file" accept="image/*">
    </div>
    <div class="form-group">
      <label for="pname">Project Name</label>
      <input id="pname" placeholder="Enter project name">
    </div>
    <div class="form-group">
      <label for="pdesc">Project Description</label>
      <textarea id="pdesc" placeholder="Enter project description"></textarea>
    </div>
    <button class="btn-primary" onclick="addProject()">Add Project</button>
  </div>

  <div class="admin-section">
    <h3>Add Client</h3>
    <div class="form-group">
      <label for="cimg">Client Image</label>
      <input id="cimg" type="file" accept="image/*">
    </div>
    <div class="form-group">
      <label for="cname">Client Name</label>
      <input id="cname" placeholder="Enter client name">
    </div>
    <div class="form-group">
      <label for="cdesc">Client Description</label>
      <textarea id="cdesc" placeholder="Enter client description"></textarea>
    </div>

    <button class="btn-primary" onclick="addClient()">Add Client</button>
  </div>

  <div class="admin-section">
    <h3>Contact Form Details</h3>
    <div id="contacts" class="data-list"></div>
  </div>

  <div class="admin-section">
    <h3>Subscribed Email Addresses</h3>
    <div id="subs" class="data-list"></div>
  </div>
</div>

<script>
const API="http://localhost:5000/api"

function addProject(){
  const formData = new FormData()
  formData.append("image", pimg.files[0])
  formData.append("title", pname.value)
  formData.append("description", pdesc.value)

  fetch(`${API}/projects`,{
    method:"POST",
    body:formData
  }).then(res=>res.json()).then(data=>{
    if(data.error) alert(data.error)
    else alert("Project Added")
  })
}

function addClient(){
  const formData = new FormData()
  formData.append("image", cimg.files[0])
  formData.append("name", cname.value)
  formData.append("review", cdesc.value)

  fetch(`${API}/clients`,{
    method:"POST",
    body:formData
  }).then(res=>res.json()).then(data=>{
    if(data.error) alert(data.error)
    else alert("Client Added")
  })
}

fetch(`${API}/contact`).then(res=>res.json())
.then(d=>contacts.innerHTML=d.map(c=>`<div class="data-item"><strong>${c.fullName}</strong><br>Email: ${c.email}<br>Mobile: ${c.mobile}<br>City: ${c.city}</div>`).join(""))

fetch(`${API}/subscribe`).then(res=>res.json())
.then(d=>subs.innerHTML=d.map(s=>`<div class="data-item"><strong>${s.email}</strong></div>`).join(""))
</script>

</body>
</html>
